<!DOCTYPE html>
<html>

<head>
    <title>Librarian Time Sheet</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>

<body>
    <div class="container mt-5">
        <h2>Librarian Time Sheet</h2>
        <p>Week Starting: <span id="weekStart"></span></p>
        <form id="timeSheetForm">
            <!-- Monday -->
            <div class="form-group">
                <label for="mondayHours">Monday</label>
                <input type="number" class="form-control" id="mondayHours" placeholder="Enter hours worked">
            </div>

            <!-- Tuesday -->
            <div class="form-group">
                <label for="tuesdayHours">Tuesday</label>
                <input type="number" class="form-control" id="tuesdayHours" placeholder="Enter hours worked">
            </div>

            <!-- Wednesday -->
            <div class="form-group">
                <label for="wednesdayHours">Wednesday</label>
                <input type="number" class="form-control" id="wednesdayHours" placeholder="Enter hours worked">
            </div>

            <!-- Thursday -->
            <div class="form-group">
                <label for="thursdayHours">Thursday</label>
                <input type="number" class="form-control" id="thursdayHours" placeholder="Enter hours worked">
            </div>

            <!-- Friday -->
            <div class="form-group">
                <label for="fridayHours">Friday</label>
                <input type="number" class="form-control" id="fridayHours" placeholder="Enter hours worked">
            </div>

            <button type="submit" class="btn btn-primary">Submit</button>
        </form>

        <div class="container" style="margin-top: 50px;">
            <a th:href="@{/}">Home</a>
        </div>

    </div>

    <!-- Bootstrap JS, Popper.js, and jQuery -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>

<script>
    function getMonday(d) {
        d = new Date(d);
        var day = d.getDay(),
            diff = d.getDate() - day + (day == 0 ? -6 : 1); // adjust when day is Sunday
        return new Date(d.setDate(diff));
    }

    function formatDate(date) {
        return date.toISOString().substring(0, 10); // format as yyyy-mm-dd
    }

    window.onload = function () {
        var monday = getMonday(new Date());
        document.getElementById("weekStart").innerText = formatDate(monday);
    };

    document.getElementById('timeSheetForm').onsubmit = function (e) {
        e.preventDefault();

        // Calculate total hours
        let totalHours = 0;
        totalHours += Number(document.getElementById('mondayHours').value);
        totalHours += Number(document.getElementById('tuesdayHours').value);
        totalHours += Number(document.getElementById('wednesdayHours').value);
        totalHours += Number(document.getElementById('thursdayHours').value);
        totalHours += Number(document.getElementById('fridayHours').value);
        // Add hours from other days similarly

        // Now, send this data to your server
        let xhr = new XMLHttpRequest();
        xhr.open("POST", "/updateHoursWorked", true);
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhr.onreadystatechange = function () {
            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
                console.log("Time Updated")
            }
        }

        // Include other necessary data, like the username
        xhr.send("totalHours=" + totalHours);
    }

</script>

</html>